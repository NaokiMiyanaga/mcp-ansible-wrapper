{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.local/mcp/jsonl.schema.json",
  "title": "MCP JSONL line schema",
  "type": "object",
  "oneOf": [
    {
      "properties": {
        "type": { "const": "network" },
        "network-id": { "type": "string" }
      },
      "required": ["type", "network-id"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "route" },
        "node-id": { "type": "string" },
        "prefix": { "type": "string" },
        "protocol": { "type": "string" },
        "nexthop": { "type": "string" }
      },
      "required": ["type", "node-id", "prefix"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "node" },
        "network-id": { "type": "string" },
        "node-id": { "type": "string" }
      },
      "required": ["type", "network-id", "node-id"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "termination-point" },
        "network-id": { "type": "string" },
        "node-id": { "type": "string" },
        "tp-id": { "type": "string" }
      },
      "required": ["type", "network-id", "node-id", "tp-id"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "frr_status" },
        "node-id": { "type": "string" },
        "version": { "type": "string" }
      },
      "required": ["type", "node-id", "version"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "bridge_status" },
        "node-id": { "type": "string" }
      },
      "required": ["type", "node-id"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "bgp_neighbor" },
        "node-id": { "type": "string" },
        "peer": { "type": "string" },
        "remote-as": { "type": ["integer", "string"] }
      },
      "required": ["type", "node-id", "peer", "remote-as"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "interface" },
        "node-id": { "type": "string" },
        "name": { "type": "string" },
        "plane": { "enum": ["management", "service", "data", "unknown"] },
        "ipv4": { "type": "string" },
        "link": { "enum": ["up", "down", "unknown"] },
        "proto": { "enum": ["up", "down", "unknown"] }
      },
      "required": ["type", "node-id", "name", "plane", "ipv4", "link"],
      "additionalProperties": true
    },
    {
      "properties": {
        "type": { "const": "summary" },
        "node-id": { "type": "string" },
        "peers_total": { "type": "integer" },
        "peers_established": { "type": "integer" },
        "peers_not_established": { "type": "integer" },
        "if_link_up_proto_down": { "type": "integer" }
      },
      "required": ["type", "node-id", "peers_total", "peers_established", "peers_not_established"],
      "additionalProperties": true
    }
  ]
}
